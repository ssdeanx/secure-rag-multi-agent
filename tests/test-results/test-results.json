{"numTotalTestSuites":95,"numPassedTestSuites":61,"numFailedTestSuites":34,"numPendingTestSuites":0,"numTotalTests":181,"numPassedTests":139,"numFailedTests":42,"numPendingTests":0,"numTodoTests":0,"snapshot":{"added":0,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0,"didUpdate":false},"startTime":1761055333977,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["streamUtils","createSSEStream"],"fullName":"streamUtils createSSEStream should create a Response with correct SSE headers","status":"passed","title":"should create a Response with correct SSE headers","duration":4.9512700000050245,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","createSSEStream"],"fullName":"streamUtils createSSEStream should call the callback with a controller","status":"passed","title":"should call the callback with a controller","duration":1.0732940000016242,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","createSSEStream"],"fullName":"streamUtils createSSEStream should send done event on completion","status":"passed","title":"should send done event on completion","duration":0.663923000000068,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","createSSEStream"],"fullName":"streamUtils createSSEStream should handle errors gracefully","status":"passed","title":"should handle errors gracefully","duration":0.7062429999932647,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","streamProgressUpdate"],"fullName":"streamUtils streamProgressUpdate should encode progress update correctly","status":"passed","title":"should encode progress update correctly","duration":0.4219719999964582,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","streamProgressUpdate"],"fullName":"streamUtils streamProgressUpdate should handle different status values","status":"passed","title":"should handle different status values","duration":0.24015099999087397,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","streamJSONEvent"],"fullName":"streamUtils streamJSONEvent should encode JSON event correctly","status":"passed","title":"should encode JSON event correctly","duration":0.3261610000045039,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","streamJSONEvent"],"fullName":"streamUtils streamJSONEvent should handle arrays","status":"passed","title":"should handle arrays","duration":0.2556510000140406,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","streamJSONEvent"],"fullName":"streamUtils streamJSONEvent should handle primitive values","status":"passed","title":"should handle primitive values","duration":0.3686420000012731,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","handleTextStream"],"fullName":"streamUtils handleTextStream should handle text stream and return full text","status":"passed","title":"should handle text stream and return full text","duration":0.4249520000012126,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","handleTextStream"],"fullName":"streamUtils handleTextStream should encode each chunk correctly","status":"passed","title":"should encode each chunk correctly","duration":0.23330100000021048,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","handleTextStream"],"fullName":"streamUtils handleTextStream should handle multi-line chunks","status":"passed","title":"should handle multi-line chunks","duration":0.18655099999159575,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","handleTextStream"],"fullName":"streamUtils handleTextStream should handle empty stream","status":"passed","title":"should handle empty stream","duration":0.12697000001207925,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","handleTextStream"],"fullName":"streamUtils handleTextStream should handle stream with special characters","status":"passed","title":"should handle stream with special characters","duration":0.26395100000081584,"failureMessages":[],"meta":{}},{"ancestorTitles":["streamUtils","Integration tests"],"fullName":"streamUtils Integration tests should work together in a typical streaming workflow","status":"passed","title":"should work together in a typical streaming workflow","duration":0.5693529999989551,"failureMessages":[],"meta":{}}],"startTime":1761055403339,"endTime":1761055403350.5693,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/utils/streamUtils.test.ts"},{"assertionResults":[{"ancestorTitles":["Custom Scorers","sourceDiversityScorer"],"fullName":"Custom Scorers sourceDiversityScorer should score high for diverse sources","status":"passed","title":"should score high for diverse sources","duration":6.622605999999905,"failureMessages":[],"meta":{}},{"ancestorTitles":["Custom Scorers","sourceDiversityScorer"],"fullName":"Custom Scorers sourceDiversityScorer should score low for single domain sources","status":"passed","title":"should score low for single domain sources","duration":1.6130969999999252,"failureMessages":[],"meta":{}},{"ancestorTitles":["Custom Scorers","researchCompletenessScorer"],"fullName":"Custom Scorers researchCompletenessScorer should score high for comprehensive research","status":"passed","title":"should score high for comprehensive research","duration":2.034658000000036,"failureMessages":[],"meta":{}},{"ancestorTitles":["Custom Scorers","researchCompletenessScorer"],"fullName":"Custom Scorers researchCompletenessScorer should score low for incomplete research","status":"passed","title":"should score low for incomplete research","duration":0.8731440000001385,"failureMessages":[],"meta":{}},{"ancestorTitles":["Custom Scorers","summaryQualityScorer"],"fullName":"Custom Scorers summaryQualityScorer should score high for good summary","status":"passed","title":"should score high for good summary","duration":1.059533999999985,"failureMessages":[],"meta":{}},{"ancestorTitles":["Custom Scorers","summaryQualityScorer"],"fullName":"Custom Scorers summaryQualityScorer should score low for poor summary","status":"passed","title":"should score low for poor summary","duration":0.7935330000000249,"failureMessages":[],"meta":{}}],"startTime":1761055405715,"endTime":1761055405728.7935,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/agents/index.test.ts"},{"assertionResults":[{"ancestorTitles":["Copywriter Agent Tool","successful content generation"],"fullName":"Copywriter Agent Tool successful content generation should generate blog content successfully with minimal parameters","status":"passed","title":"should generate blog content successfully with minimal parameters","duration":4.8573990000004414,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","successful content generation"],"fullName":"Copywriter Agent Tool successful content generation should generate marketing content with all parameters","status":"passed","title":"should generate marketing content with all parameters","duration":0.9664939999929629,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","successful content generation"],"fullName":"Copywriter Agent Tool successful content generation should generate social media content","status":"passed","title":"should generate social media content","duration":0.7421630000026198,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","successful content generation"],"fullName":"Copywriter Agent Tool successful content generation should generate technical content","status":"passed","title":"should generate technical content","duration":0.5809420000005048,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","successful content generation"],"fullName":"Copywriter Agent Tool successful content generation should handle content without title","status":"passed","title":"should handle content without title","duration":0.5750930000067456,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","successful content generation"],"fullName":"Copywriter Agent Tool successful content generation should truncate long summaries","status":"passed","title":"should truncate long summaries","duration":0.5015920000005281,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","error handling"],"fullName":"Copywriter Agent Tool error handling should throw error for unsupported content type","status":"passed","title":"should throw error for unsupported content type","duration":2.485000000000582,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","error handling"],"fullName":"Copywriter Agent Tool error handling should handle agent generation errors","status":"passed","title":"should handle agent generation errors","duration":0.7725630000059027,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","error handling"],"fullName":"Copywriter Agent Tool error handling should handle non-Error exceptions","status":"passed","title":"should handle non-Error exceptions","duration":0.9656640000030166,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","tracing"],"fullName":"Copywriter Agent Tool tracing should create and end tracing spans correctly","status":"passed","title":"should create and end tracing spans correctly","duration":1.9238880000048084,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","tracing"],"fullName":"Copywriter Agent Tool tracing should handle tracing on error","status":"passed","title":"should handle tracing on error","duration":1.28608499999973,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","content parsing"],"fullName":"Copywriter Agent Tool content parsing should extract title from H1 headers","status":"passed","title":"should extract title from H1 headers","duration":0.39267100000870414,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","content parsing"],"fullName":"Copywriter Agent Tool content parsing should extract title from H2 headers","status":"passed","title":"should extract title from H2 headers","duration":0.3961819999967702,"failureMessages":[],"meta":{}},{"ancestorTitles":["Copywriter Agent Tool","content parsing"],"fullName":"Copywriter Agent Tool content parsing should calculate word count correctly","status":"passed","title":"should calculate word count correctly","duration":0.2995410000003176,"failureMessages":[],"meta":{}}],"startTime":1761055403410,"endTime":1761055403427.3962,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/copywriter-agent-tool.test.ts"},{"assertionResults":[{"ancestorTitles":["Data File Manager Tools","readDataFileTool"],"fullName":"Data File Manager Tools readDataFileTool should read file content successfully","status":"passed","title":"should read file content successfully","duration":10.42701099999249,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","readDataFileTool"],"fullName":"Data File Manager Tools readDataFileTool should throw error for path outside data directory","status":"passed","title":"should throw error for path outside data directory","duration":2.0466180000075838,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","readDataFileTool"],"fullName":"Data File Manager Tools readDataFileTool should handle file read errors","status":"passed","title":"should handle file read errors","duration":0.9157940000004601,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","writeDataFileTool"],"fullName":"Data File Manager Tools writeDataFileTool should write file content successfully","status":"passed","title":"should write file content successfully","duration":1.6540470000036294,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","writeDataFileTool"],"fullName":"Data File Manager Tools writeDataFileTool should create directory if it does not exist","status":"passed","title":"should create directory if it does not exist","duration":1.4478550000058021,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","writeDataFileTool"],"fullName":"Data File Manager Tools writeDataFileTool should throw error for invalid directory path","status":"passed","title":"should throw error for invalid directory path","duration":0.8317129999923054,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","deleteDataFileTool"],"fullName":"Data File Manager Tools deleteDataFileTool should delete file successfully","status":"passed","title":"should delete file successfully","duration":1.3208549999981187,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","deleteDataFileTool"],"fullName":"Data File Manager Tools deleteDataFileTool should throw error for path outside data directory","status":"passed","title":"should throw error for path outside data directory","duration":2.6003300000011222,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","listDataDirTool"],"fullName":"Data File Manager Tools listDataDirTool should list directory contents successfully","status":"passed","title":"should list directory contents successfully","duration":1.8129570000019157,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","listDataDirTool"],"fullName":"Data File Manager Tools listDataDirTool should use default path when dirPath is not provided","status":"passed","title":"should use default path when dirPath is not provided","duration":0.9499939999950584,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","copyDataFileTool"],"fullName":"Data File Manager Tools copyDataFileTool should copy file successfully","status":"passed","title":"should copy file successfully","duration":1.3606759999966016,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","copyDataFileTool"],"fullName":"Data File Manager Tools copyDataFileTool should create destination directory if needed","status":"passed","title":"should create destination directory if needed","duration":0.9163039999984903,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","moveDataFileTool"],"fullName":"Data File Manager Tools moveDataFileTool should move file successfully","status":"passed","title":"should move file successfully","duration":1.6038260000059381,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","searchDataFilesTool"],"fullName":"Data File Manager Tools searchDataFilesTool should search files by name successfully","status":"passed","title":"should search files by name successfully","duration":1.6270459999941522,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","searchDataFilesTool"],"fullName":"Data File Manager Tools searchDataFilesTool should search file content when searchContent is true","status":"passed","title":"should search file content when searchContent is true","duration":0.9080739999917569,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","searchDataFilesTool"],"fullName":"Data File Manager Tools searchDataFilesTool should throw error for pattern too long","status":"passed","title":"should throw error for pattern too long","duration":0.6785830000007991,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","getDataFileInfoTool"],"fullName":"Data File Manager Tools getDataFileInfoTool should get file info successfully","status":"passed","title":"should get file info successfully","duration":0.991544000004069,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","createDataDirTool"],"fullName":"Data File Manager Tools createDataDirTool should create directory successfully","status":"passed","title":"should create directory successfully","duration":1.0911740000010468,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","removeDataDirTool"],"fullName":"Data File Manager Tools removeDataDirTool should remove empty directory successfully","status":"passed","title":"should remove empty directory successfully","duration":0.8299439999973401,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","removeDataDirTool"],"fullName":"Data File Manager Tools removeDataDirTool should throw error for non-empty directory","status":"passed","title":"should throw error for non-empty directory","duration":0.6543520000122953,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","archiveDataTool"],"fullName":"Data File Manager Tools archiveDataTool should archive file successfully","status":"passed","title":"should archive file successfully","duration":3.9049960000120336,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","backupDataTool"],"fullName":"Data File Manager Tools backupDataTool should create backup successfully","status":"passed","title":"should create backup successfully","duration":1.5494960000069113,"failureMessages":[],"meta":{}},{"ancestorTitles":["Data File Manager Tools","backupDataTool"],"fullName":"Data File Manager Tools backupDataTool should use custom backup directory","status":"passed","title":"should use custom backup directory","duration":0.6645629999984521,"failureMessages":[],"meta":{}}],"startTime":1761055403467,"endTime":1761055403508.6646,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/data-file-manager.test.ts"},{"assertionResults":[{"ancestorTitles":["mastraChunker"],"fullName":"mastraChunker should validate input schema","status":"passed","title":"should validate input schema","duration":4.640949000007822,"failureMessages":[],"meta":{}},{"ancestorTitles":["mastraChunker"],"fullName":"mastraChunker should successfully chunk document with recursive strategy","status":"passed","title":"should successfully chunk document with recursive strategy","duration":5.567322000002605,"failureMessages":[],"meta":{}},{"ancestorTitles":["mastraChunker"],"fullName":"mastraChunker should handle different chunking strategies","status":"passed","title":"should handle different chunking strategies","duration":13.696324000004097,"failureMessages":[],"meta":{}},{"ancestorTitles":["mastraChunker"],"fullName":"mastraChunker should extract metadata when requested","status":"passed","title":"should extract metadata when requested","duration":2.533130000010715,"failureMessages":[],"meta":{}},{"ancestorTitles":["mastraChunker"],"fullName":"mastraChunker should handle chunking errors gracefully","status":"passed","title":"should handle chunking errors gracefully","duration":8.11780199999339,"failureMessages":[],"meta":{}},{"ancestorTitles":["mastraChunker"],"fullName":"mastraChunker should handle tracing context without current span","status":"passed","title":"should handle tracing context without current span","duration":1.2854450000013458,"failureMessages":[],"meta":{}}],"startTime":1761055404671,"endTime":1761055404707.2854,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/document-chunking.tool.test.ts"},{"assertionResults":[{"ancestorTitles":["Editor Agent Tool","successful content editing"],"fullName":"Editor Agent Tool successful content editing should edit blog content successfully with minimal parameters","status":"passed","title":"should edit blog content successfully with minimal parameters","duration":6.039764000001014,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","successful content editing"],"fullName":"Editor Agent Tool successful content editing should edit technical content with all parameters","status":"passed","title":"should edit technical content with all parameters","duration":0.896402999991551,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","successful content editing"],"fullName":"Editor Agent Tool successful content editing should edit business content","status":"passed","title":"should edit business content","duration":1.3225149999925634,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","successful content editing"],"fullName":"Editor Agent Tool successful content editing should handle non-JSON response with fallback parsing","status":"passed","title":"should handle non-JSON response with fallback parsing","duration":0.5875020000094082,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","successful content editing"],"fullName":"Editor Agent Tool successful content editing should handle JSON response with missing fields","status":"passed","title":"should handle JSON response with missing fields","duration":0.5229120000003604,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","successful content editing"],"fullName":"Editor Agent Tool successful content editing should handle JSON response with alternative field names","status":"passed","title":"should handle JSON response with alternative field names","duration":0.49252200000046287,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","error handling"],"fullName":"Editor Agent Tool error handling should handle agent generation errors","status":"passed","title":"should handle agent generation errors","duration":1.5261259999970207,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","error handling"],"fullName":"Editor Agent Tool error handling should handle non-Error exceptions","status":"passed","title":"should handle non-Error exceptions","duration":0.47267200000351295,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","tracing"],"fullName":"Editor Agent Tool tracing should create and end tracing spans correctly","status":"passed","title":"should create and end tracing spans correctly","duration":2.4580599999899277,"failureMessages":[],"meta":{}},{"ancestorTitles":["Editor Agent Tool","tracing"],"fullName":"Editor Agent Tool tracing should handle tracing on error","status":"passed","title":"should handle tracing on error","duration":1.129584000009345,"failureMessages":[],"meta":{}}],"startTime":1761055403363,"endTime":1761055403379.1296,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/editor-agent-tool.test.ts"},{"assertionResults":[{"ancestorTitles":["Evaluate Result Tool","successful evaluation"],"fullName":"Evaluate Result Tool successful evaluation should evaluate result as relevant","status":"failed","title":"should evaluate result as relevant","duration":19.53436699998565,"failureMessages":["AssertionError: expected \"spy\" to be called with arguments: [ ArrayContaining{…}, …(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[32m-   ArrayContaining [\u001b[90m\n\u001b[32m-     ObjectContaining {\u001b[90m\n\u001b[32m-       \"content\": StringContaining \"Evaluate whether this search result is relevant\",\u001b[90m\n\u001b[31m+   [\u001b[90m\n\u001b[31m+     {\u001b[90m\n\u001b[31m+       \"content\": \"Evaluate whether this search result is relevant and will help answer the query: \\\"What are the best machine learning algorithms?\\\".\u001b[90m\n\u001b[31m+\u001b[90m\n\u001b[31m+         Search result:\u001b[90m\n\u001b[31m+         Title: Top 10 Machine Learning Algorithms\u001b[90m\n\u001b[31m+         URL: https://example.com/ml-algorithms\u001b[90m\n\u001b[31m+         Content snippet: This article covers the most important machine learning algorithms including......\u001b[90m\n\u001b[31m+\u001b[90m\n\u001b[31m+         Respond with a JSON object containing:\u001b[90m\n\u001b[31m+         - isRelevant: boolean indicating if the result is relevant\u001b[90m\n\u001b[31m+         - reason: brief explanation of your decision\",\u001b[90m\n\u001b[2m        \"role\": \"user\",\u001b[22m\n\u001b[2m      },\u001b[22m\n\u001b[2m    ],\u001b[22m\n\u001b[32m-   ObjectContaining {\u001b[90m\n\u001b[32m-     \"experimental_output\": Any<Object>,\u001b[90m\n\u001b[32m-   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m1\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/evaluateResultTool.test.ts:87:40\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","successful evaluation"],"fullName":"Evaluate Result Tool successful evaluation should evaluate result as not relevant","status":"passed","title":"should evaluate result as not relevant","duration":1.7815370000025723,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","successful evaluation"],"fullName":"Evaluate Result Tool successful evaluation should handle evaluation with existing URLs","status":"passed","title":"should handle evaluation with existing URLs","duration":1.5330959999992047,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","URL filtering"],"fullName":"Evaluate Result Tool URL filtering should return false for already processed URL","status":"passed","title":"should return false for already processed URL","duration":1.2005340000032447,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","URL filtering"],"fullName":"Evaluate Result Tool URL filtering should proceed with evaluation when no existing URLs provided","status":"passed","title":"should proceed with evaluation when no existing URLs provided","duration":1.3779059999942547,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","error handling"],"fullName":"Evaluate Result Tool error handling should handle agent generation errors","status":"passed","title":"should handle agent generation errors","duration":2.0749780000041937,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","error handling"],"fullName":"Evaluate Result Tool error handling should handle non-Error exceptions","status":"passed","title":"should handle non-Error exceptions","duration":1.473145999989356,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","error handling"],"fullName":"Evaluate Result Tool error handling should handle mastra not available","status":"passed","title":"should handle mastra not available","duration":1.10907400000724,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","tracing"],"fullName":"Evaluate Result Tool tracing should create and end tracing spans correctly","status":"passed","title":"should create and end tracing spans correctly","duration":1.5706859999918379,"failureMessages":[],"meta":{}},{"ancestorTitles":["Evaluate Result Tool","tracing"],"fullName":"Evaluate Result Tool tracing should handle tracing on error","status":"passed","title":"should handle tracing on error","duration":1.3104249999887543,"failureMessages":[],"meta":{}}],"startTime":1761055403399,"endTime":1761055403432.3105,"status":"failed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/evaluateResultTool.test.ts"},{"assertionResults":[{"ancestorTitles":["Extract Learnings Tool","successful learning extraction"],"fullName":"Extract Learnings Tool successful learning extraction should extract learnings successfully with complete response","status":"failed","title":"should extract learnings successfully with complete response","duration":18.44762200000696,"failureMessages":["AssertionError: expected \"spy\" to be called with arguments: [ [ { role: 'user', …(1) } ], …(1) ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[2m    [\u001b[22m\n\u001b[2m      {\u001b[22m\n\u001b[32m-       \"content\": StringContaining \"The user is researching \\\"machine learning validation\\\"\",\u001b[90m\n\u001b[31m+       \"content\": \"The user is researching \\\"machine learning validation\\\".\u001b[90m\n\u001b[31m+             Extract a key learning and generate follow-up questions from this search result:\u001b[90m\n\u001b[31m+\u001b[90m\n\u001b[31m+             Title: Model Validation Best Practices\u001b[90m\n\u001b[31m+             URL: https://example.com/ml-validation\u001b[90m\n\u001b[31m+             Content: Machine learning models need validation......\u001b[90m\n\u001b[31m+\u001b[90m\n\u001b[31m+             Respond with a JSON object containing:\u001b[90m\n\u001b[31m+             - learning: string with the key insight from the content\u001b[90m\n\u001b[31m+             - followUpQuestions: array of up to 1 follow-up question for deeper research\",\u001b[90m\n\u001b[2m        \"role\": \"user\",\u001b[22m\n\u001b[2m      },\u001b[22m\n\u001b[2m    ],\u001b[22m\n\u001b[32m-   {\u001b[90m\n\u001b[32m-     \"experimental_output\": Any<Object>,\u001b[90m\n\u001b[32m-   },\u001b[90m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m1\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/extractLearningsTool.test.ts:94:40\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","successful learning extraction"],"fullName":"Extract Learnings Tool successful learning extraction should handle content truncation for long content","status":"failed","title":"should handle content truncation for long content","duration":11.352226000002702,"failureMessages":["AssertionError: expected 'The user is researching \"long documen…' to contain 'Content: AAAAAA...'\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/extractLearningsTool.test.ts:142:34\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","successful learning extraction"],"fullName":"Extract Learnings Tool successful learning extraction should extract learnings with empty follow-up questions","status":"passed","title":"should extract learnings with empty follow-up questions","duration":1.7052659999899333,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","successful learning extraction"],"fullName":"Extract Learnings Tool successful learning extraction should handle special characters in content","status":"passed","title":"should handle special characters in content","duration":1.1796849999955157,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","error handling"],"fullName":"Extract Learnings Tool error handling should handle missing mastra instance","status":"passed","title":"should handle missing mastra instance","duration":2.9296209999884013,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","error handling"],"fullName":"Extract Learnings Tool error handling should handle missing learningExtractionAgent","status":"passed","title":"should handle missing learningExtractionAgent","duration":1.0830249999999069,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","error handling"],"fullName":"Extract Learnings Tool error handling should handle agent generation errors","status":"passed","title":"should handle agent generation errors","duration":1.203655000004801,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","error handling"],"fullName":"Extract Learnings Tool error handling should handle non-Error exceptions","status":"failed","title":"should handle non-Error exceptions","duration":1.878007000006619,"failureMessages":["AssertionError: expected { …(2) } to deeply equal { …(2) }\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/extractLearningsTool.test.ts:302:28\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","tracing"],"fullName":"Extract Learnings Tool tracing should create and end tracing spans correctly","status":"failed","title":"should create and end tracing spans correctly","duration":2.220698999997694,"failureMessages":["AssertionError: expected \"spy\" to be called with arguments: [ { type: Any<String>, …(2) } ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[2m  [\u001b[22m\n\u001b[2m    {\u001b[22m\n\u001b[2m      \"input\": {\u001b[22m\n\u001b[32m-       \"contentLength\": 47,\u001b[90m\n\u001b[31m+       \"contentLength\": 45,\u001b[90m\n\u001b[2m        \"query\": \"tracing test query\",\u001b[22m\n\u001b[2m        \"url\": \"https://example.com/trace\",\u001b[22m\n\u001b[2m      },\u001b[22m\n\u001b[2m      \"name\": \"extract_learnings\",\u001b[22m\n\u001b[32m-     \"type\": Any<String>,\u001b[90m\n\u001b[31m+     \"type\": \"tool_call\",\u001b[90m\n\u001b[2m    },\u001b[22m\n\u001b[2m  ]\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m1\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/extractLearningsTool.test.ts:336:15\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","tracing"],"fullName":"Extract Learnings Tool tracing should handle tracing on error","status":"passed","title":"should handle tracing on error","duration":1.1457250000094064,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","tracing"],"fullName":"Extract Learnings Tool tracing should handle tracing with null response object","status":"failed","title":"should handle tracing with null response object","duration":2.1277180000033695,"failureMessages":["AssertionError: expected \"spy\" to be called with arguments: [ { output: { …(2) } } ]\u001b[90m\n\nReceived: \n\n\u001b[1m  1st spy call:\n\n\u001b[22m\u001b[33m@@ -1,7 +1,10 @@\u001b[90m\n\u001b[2m  [\u001b[22m\n\u001b[2m    {\u001b[22m\n\u001b[31m+     \"metadata\": {\u001b[90m\n\u001b[31m+       \"invalidResponse\": true,\u001b[90m\n\u001b[31m+     },\u001b[90m\n\u001b[2m      \"output\": {\u001b[22m\n\u001b[2m        \"followUpQuestionsCount\": 0,\u001b[22m\n\u001b[2m        \"learningLength\": 0,\u001b[22m\n\u001b[2m      },\u001b[22m\n\u001b[2m    },\u001b[22m\n\u001b[39m\u001b[90m\n\nNumber of calls: \u001b[1m1\u001b[22m\n\u001b[39m\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1355:10)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/extractLearningsTool.test.ts:399:34\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","input validation"],"fullName":"Extract Learnings Tool input validation should handle empty content","status":"passed","title":"should handle empty content","duration":1.1214340000005905,"failureMessages":[],"meta":{}},{"ancestorTitles":["Extract Learnings Tool","input validation"],"fullName":"Extract Learnings Tool input validation should handle very short content","status":"passed","title":"should handle very short content","duration":0.8702729999931762,"failureMessages":[],"meta":{}}],"startTime":1761055403409,"endTime":1761055403456.8704,"status":"failed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/extractLearningsTool.test.ts"},{"assertionResults":[{"ancestorTitles":["Graph RAG Query Tool","successful graph queries"],"fullName":"Graph RAG Query Tool successful graph queries should execute graph query successfully with default parameters","status":"failed","title":"should execute graph query successfully with default parameters","duration":17.070265999995172,"failureMessages":["AssertionError: expected { contexts: [ { …(9) }, { …(9) } ] } to deeply equal { contexts: [ { …(9) }, { …(9) } ] }\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:134:28\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","successful graph queries"],"fullName":"Graph RAG Query Tool successful graph queries should execute graph query with custom parameters","status":"passed","title":"should execute graph query with custom parameters","duration":3.009301999991294,"failureMessages":[],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","successful graph queries"],"fullName":"Graph RAG Query Tool successful graph queries should handle empty results","status":"failed","title":"should handle empty results","duration":0.7257929999905173,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockResolvedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:230:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","successful graph queries"],"fullName":"Graph RAG Query Tool successful graph queries should disable graph traversal when includeRelated is false","status":"failed","title":"should disable graph traversal when includeRelated is false","duration":2.4609889999992447,"failureMessages":["AssertionError: expected { text: 'Engineering context', …(6) } to have property \"relationshipScore\" with value 0.8\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:276:40\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","error handling"],"fullName":"Graph RAG Query Tool error handling should throw error when access filter is missing","status":"passed","title":"should throw error when access filter is missing","duration":1.3849049999989802,"failureMessages":[],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","error handling"],"fullName":"Graph RAG Query Tool error handling should handle vector query service errors","status":"failed","title":"should handle vector query service errors","duration":0.5944329999911133,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockRejectedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:302:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","error handling"],"fullName":"Graph RAG Query Tool error handling should handle non-Error exceptions","status":"failed","title":"should handle non-Error exceptions","duration":0.46243200000026263,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockRejectedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:321:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","tracing"],"fullName":"Graph RAG Query Tool tracing should create and end tracing spans correctly","status":"passed","title":"should create and end tracing spans correctly","duration":1.8369870000024093,"failureMessages":[],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","tracing"],"fullName":"Graph RAG Query Tool tracing should handle tracing on error","status":"failed","title":"should handle tracing on error","duration":0.5218319999985397,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockRejectedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:402:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","validation"],"fullName":"Graph RAG Query Tool validation should validate environment variables","status":"failed","title":"should validate environment variables","duration":0.43635200000426266,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockResolvedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:432:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","request tracking"],"fullName":"Graph RAG Query Tool request tracking should generate request ID when not in context","status":"failed","title":"should generate request ID when not in context","duration":0.5037519999896176,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockResolvedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:461:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Graph RAG Query Tool","request tracking"],"fullName":"Graph RAG Query Tool request tracking should extract request ID from context","status":"failed","title":"should extract request ID from context","duration":0.3438319999986561,"failureMessages":["TypeError: mockRuntimeContext.get.mockReturnValue(...)(...).mockResolvedValue is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts:481:18\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}}],"startTime":1761055403409,"endTime":1761055403438.5037,"status":"failed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/graph-rag-query.tool.test.ts"},{"assertionResults":[{"ancestorTitles":["jwtAuthTool"],"fullName":"jwtAuthTool should successfully verify JWT and return claims","status":"passed","title":"should successfully verify JWT and return claims","duration":4.084166000000096,"failureMessages":[],"meta":{}},{"ancestorTitles":["jwtAuthTool"],"fullName":"jwtAuthTool should throw error when JWT not found in runtime context","status":"passed","title":"should throw error when JWT not found in runtime context","duration":1.7976369999998951,"failureMessages":[],"meta":{}},{"ancestorTitles":["jwtAuthTool"],"fullName":"jwtAuthTool should handle JWT verification errors","status":"passed","title":"should handle JWT verification errors","duration":0.7444030000001476,"failureMessages":[],"meta":{}},{"ancestorTitles":["jwtAuthTool"],"fullName":"jwtAuthTool should handle tracing context without current span","status":"passed","title":"should handle tracing context without current span","duration":0.3899220000000696,"failureMessages":[],"meta":{}}],"startTime":1761055404611,"endTime":1761055404618.39,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/jwt-auth.tool.test.ts"},{"assertionResults":[{"ancestorTitles":["SerpAPI Academic and Local Tools"],"fullName":"SerpAPI Academic and Local Tools should load academic and local tools without errors","status":"passed","title":"should load academic and local tools without errors","duration":1.1578250000000025,"failureMessages":[],"meta":{}}],"startTime":1761055404408,"endTime":1761055404409.1577,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/serpapi-academic-local.tool.test.ts"},{"assertionResults":[],"startTime":1761055333977,"endTime":1761055333977,"status":"failed","message":"[vitest] No \"config\" export is defined on the \"serpapi\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/serpapi-news-trends.tool.test.ts"},{"assertionResults":[],"startTime":1761055333977,"endTime":1761055333977,"status":"failed","message":"[vitest] No \"config\" export is defined on the \"serpapi\" mock. Did you forget to return it from \"vi.mock\"?\nIf you need to partially mock a module, you can use \"importOriginal\" helper inside:\n","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/serpapi-search.tool.test.ts"},{"assertionResults":[{"ancestorTitles":["SerpAPI Shopping Tools"],"fullName":"SerpAPI Shopping Tools should load shopping tools without errors","status":"passed","title":"should load shopping tools without errors","duration":1.169595000000072,"failureMessages":[],"meta":{}}],"startTime":1761055404374,"endTime":1761055404375.1697,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/serpapi-shopping.tool.test.ts"},{"assertionResults":[{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should successfully query vector database","status":"passed","title":"should successfully query vector database","duration":8.193242999999939,"failureMessages":[],"meta":{}},{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should throw error when access filter not found","status":"passed","title":"should throw error when access filter not found","duration":1.7247569999999541,"failureMessages":[],"meta":{}},{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should handle validation errors","status":"passed","title":"should handle validation errors","duration":0.6987420000000384,"failureMessages":[],"meta":{}},{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should handle vector query service errors","status":"passed","title":"should handle vector query service errors","duration":0.7074229999998352,"failureMessages":[],"meta":{}},{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should use default topK when not provided","status":"passed","title":"should use default topK when not provided","duration":1.2954349999999977,"failureMessages":[],"meta":{}},{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should use custom similarity threshold from environment","status":"passed","title":"should use custom similarity threshold from environment","duration":0.7524829999999838,"failureMessages":[],"meta":{}},{"ancestorTitles":["vectorQueryTool"],"fullName":"vectorQueryTool should handle tracing context without current span","status":"passed","title":"should handle tracing context without current span","duration":0.4548420000000988,"failureMessages":[],"meta":{}}],"startTime":1761055404636,"endTime":1761055404650.4548,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/vector-query.tool.test.ts"},{"assertionResults":[{"ancestorTitles":["weatherTool"],"fullName":"weatherTool should successfully fetch weather data","status":"passed","title":"should successfully fetch weather data","duration":11.397776000000022,"failureMessages":[],"meta":{}},{"ancestorTitles":["weatherTool"],"fullName":"weatherTool should handle location not found","status":"passed","title":"should handle location not found","duration":2.836671000000024,"failureMessages":[],"meta":{}},{"ancestorTitles":["weatherTool"],"fullName":"weatherTool should handle API errors","status":"passed","title":"should handle API errors","duration":1.74364700000001,"failureMessages":[],"meta":{}},{"ancestorTitles":["weatherTool"],"fullName":"weatherTool should use fahrenheit when specified","status":"passed","title":"should use fahrenheit when specified","duration":0.9498730000000251,"failureMessages":[],"meta":{}},{"ancestorTitles":["weatherTool"],"fullName":"weatherTool should handle tracing context errors","status":"passed","title":"should handle tracing context errors","duration":1.61228600000004,"failureMessages":[],"meta":{}}],"startTime":1761055404604,"endTime":1761055404622.6123,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/weather-tool.test.ts"},{"assertionResults":[{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","sanitizeHtml"],"fullName":"Web Scraper Tool Tests HtmlProcessor sanitizeHtml should sanitize HTML by removing script and style tags","status":"failed","title":"should sanitize HTML by removing script and style tags","duration":35.21876899999984,"failureMessages":["AssertionError: expected '<h1>Hello</h1>' to be '<html><head></head><body><h1>Hello</h…' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:197:32\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","sanitizeHtml"],"fullName":"Web Scraper Tool Tests HtmlProcessor sanitizeHtml should handle empty HTML","status":"failed","title":"should handle empty HTML","duration":9.113894999999957,"failureMessages":["AssertionError: expected '' to be '<html><head></head><body></body></htm…' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:204:32\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","sanitizeHtml"],"fullName":"Web Scraper Tool Tests HtmlProcessor sanitizeHtml should handle HTML with only script tags","status":"failed","title":"should handle HTML with only script tags","duration":7.876130999999987,"failureMessages":["AssertionError: expected '' to be '<html><head></head><body></body></htm…' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:210:32\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","sanitizeHtml"],"fullName":"Web Scraper Tool Tests HtmlProcessor sanitizeHtml should handle JSDOM errors gracefully","status":"failed","title":"should handle JSDOM errors gracefully","duration":0.5327819999999974,"failureMessages":["TypeError: mockJSDOM.mockImplementationOnce is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:214:27\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","extractTextContent"],"fullName":"Web Scraper Tool Tests HtmlProcessor extractTextContent should extract text content from HTML","status":"failed","title":"should extract text content from HTML","duration":9.95945000000006,"failureMessages":["TypeError: [Function JSDOM] is not a spy or a call to a spy!\n    at assertIsMock (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1299:10)\n    at getSpy (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1303:3)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1344:15)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:231:35\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","extractTextContent"],"fullName":"Web Scraper Tool Tests HtmlProcessor extractTextContent should handle empty HTML","status":"passed","title":"should handle empty HTML","duration":6.58673500000009,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","extractTextContent"],"fullName":"Web Scraper Tool Tests HtmlProcessor extractTextContent should handle HTML parsing errors","status":"failed","title":"should handle HTML parsing errors","duration":0.44507100000009814,"failureMessages":["TypeError: mockJSDOM.mockImplementation is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:240:27\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","htmlToMarkdown"],"fullName":"Web Scraper Tool Tests HtmlProcessor htmlToMarkdown should convert HTML to markdown","status":"passed","title":"should convert HTML to markdown","duration":10.864354000000048,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","htmlToMarkdown"],"fullName":"Web Scraper Tool Tests HtmlProcessor htmlToMarkdown should handle empty HTML","status":"passed","title":"should handle empty HTML","duration":18.15575100000001,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","htmlToMarkdown"],"fullName":"Web Scraper Tool Tests HtmlProcessor htmlToMarkdown should handle conversion errors","status":"failed","title":"should handle conversion errors","duration":1.033154000000195,"failureMessages":["TypeError: mockJSDOM.mockImplementation is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:266:27\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","HtmlProcessor","sanitizeMarkdown"],"fullName":"Web Scraper Tool Tests HtmlProcessor sanitizeMarkdown should sanitize markdown by removing dangerous HTML","status":"passed","title":"should sanitize markdown by removing dangerous HTML","duration":0.2973210000000108,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","validateUrl"],"fullName":"Web Scraper Tool Tests ValidationUtils validateUrl should validate valid URLs","status":"passed","title":"should validate valid URLs","duration":1.7359470000001238,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","validateUrl"],"fullName":"Web Scraper Tool Tests ValidationUtils validateUrl should reject invalid URLs","status":"failed","title":"should reject invalid URLs","duration":0.6721430000000055,"failureMessages":["AssertionError: expected function to throw an error, but it didn't\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:301:72\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","sanitizeFileName"],"fullName":"Web Scraper Tool Tests ValidationUtils sanitizeFileName should sanitize filenames by removing invalid characters","status":"failed","title":"should sanitize filenames by removing invalid characters","duration":1.265485000000126,"failureMessages":["AssertionError: expected 'file_name_.txt' to be 'filename.txt' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:315:76\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","sanitizeFileName"],"fullName":"Web Scraper Tool Tests ValidationUtils sanitizeFileName should handle empty filenames","status":"failed","title":"should handle empty filenames","duration":0.5835320000001047,"failureMessages":["AssertionError: expected '' to be 'untitled' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:327:62\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","sanitizeFileName"],"fullName":"Web Scraper Tool Tests ValidationUtils sanitizeFileName should handle filenames with only invalid characters","status":"failed","title":"should handle filenames with only invalid characters","duration":0.5127019999999902,"failureMessages":["AssertionError: expected '_______' to be 'untitled' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:331:69\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","validateFilePath"],"fullName":"Web Scraper Tool Tests ValidationUtils validateFilePath should validate file paths within intended directory","status":"passed","title":"should validate file paths within intended directory","duration":0.25941100000000006,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ValidationUtils","validateFilePath"],"fullName":"Web Scraper Tool Tests ValidationUtils validateFilePath should reject file paths outside intended directory","status":"failed","title":"should reject file paths outside intended directory","duration":0.3088319999999385,"failureMessages":["AssertionError: expected function to throw an error, but it didn't\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:353:19\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ScrapingError"],"fullName":"Web Scraper Tool Tests ScrapingError should create error with message","status":"passed","title":"should create error with message","duration":0.28034100000013495,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","ScrapingError"],"fullName":"Web Scraper Tool Tests ScrapingError should create error with message and additional details","status":"passed","title":"should create error with message and additional details","duration":0.23737099999993916,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","webScraperTool"],"fullName":"Web Scraper Tool Tests webScraperTool should scrape a webpage and return content","status":"failed","title":"should scrape a webpage and return content","duration":9.036835999999994,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:392:35\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","webScraperTool"],"fullName":"Web Scraper Tool Tests webScraperTool should handle scraping errors","status":"failed","title":"should handle scraping errors","duration":5.544102000000066,"failureMessages":["Error: promise resolved \"{ url: 'https://example.com', …(6) }\" instead of rejecting\n    at _Assertion.__VITEST_REJECTS__ (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1610:17)\n    at _Assertion.propertyGetter (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1557:27)\n    at Reflect.get (<anonymous>)\n    at Object.proxyGetter [as get] (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1645:22)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:403:13\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","webScraperTool"],"fullName":"Web Scraper Tool Tests webScraperTool should validate URL before scraping","status":"failed","title":"should validate URL before scraping","duration":2.411059000000023,"failureMessages":["Error: promise resolved \"{ error: true, …(2) }\" instead of rejecting\n    at _Assertion.__VITEST_REJECTS__ (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1610:17)\n    at _Assertion.propertyGetter (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1557:27)\n    at Reflect.get (<anonymous>)\n    at Object.proxyGetter [as get] (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1645:22)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:413:13\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","htmlToMarkdownTool"],"fullName":"Web Scraper Tool Tests htmlToMarkdownTool should convert HTML to markdown successfully","status":"passed","title":"should convert HTML to markdown successfully","duration":24.638975999999957,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","htmlToMarkdownTool"],"fullName":"Web Scraper Tool Tests htmlToMarkdownTool should handle conversion errors","status":"failed","title":"should handle conversion errors","duration":0.4008110000002034,"failureMessages":["TypeError: mockJSDOM.mockImplementationOnce is not a function\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:431:23\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20\n    at new Promise (<anonymous>)\n    at runWithTimeout (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)\n    at runTest (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)\n    at runSuite (file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","batchWebScraperTool"],"fullName":"Web Scraper Tool Tests batchWebScraperTool should scrape multiple URLs","status":"failed","title":"should scrape multiple URLs","duration":2.7064809999999397,"failureMessages":["AssertionError: expected [] to have a length of 2 but got +0\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1257:20)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:456:36\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","batchWebScraperTool"],"fullName":"Web Scraper Tool Tests batchWebScraperTool should handle invalid URLs in batch","status":"failed","title":"should handle invalid URLs in batch","duration":0.910914000000048,"failureMessages":["AssertionError: Target cannot be null or undefined.\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1257:20)\n    at Proxy.<anonymous> (file:///home/sam/mastra-governed-rag/node_modules/@vitest/expect/dist/index.js:1029:14)\n    at Proxy.methodWrapper (file:///home/sam/mastra-governed-rag/node_modules/chai/index.js:1686:25)\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:469:36\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","siteMapExtractorTool"],"fullName":"Web Scraper Tool Tests siteMapExtractorTool should extract site map from URL","status":"failed","title":"should extract site map from URL","duration":2.651740000000018,"failureMessages":["AssertionError: expected 0 to be greater than or equal to 1\n    at /home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts:486:39\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","linkExtractorTool"],"fullName":"Web Scraper Tool Tests linkExtractorTool should extract links from HTML","status":"failed","title":"should extract links from HTML","duration":3.074621999999863,"failureMessages":["ScrapingError: Failed to retrieve page content (code=NO_CONTENT)\n    at execute (/home/sam/mastra-governed-rag/src/mastra/tools/web-scraper-tool.ts:1291:23)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","listScrapedContentTool"],"fullName":"Web Scraper Tool Tests listScrapedContentTool should list scraped content files","status":"passed","title":"should list scraped content files","duration":1.762796999999864,"failureMessages":[],"meta":{}},{"ancestorTitles":["Web Scraper Tool Tests","contentCleanerTool"],"fullName":"Web Scraper Tool Tests contentCleanerTool should clean HTML content","status":"passed","title":"should clean HTML content","duration":7.01060799999982,"failureMessages":[],"meta":{}}],"startTime":1761055405521,"endTime":1761055405688.0105,"status":"failed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/tools/tests/web-scraper-tool.test.ts"},{"assertionResults":[{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should execute workflow with valid input data and return response","status":"passed","title":"should execute workflow with valid input data and return response","duration":6.947677999999996,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should handle prompt without temperature","status":"passed","title":"should handle prompt without temperature","duration":2.1856079999997746,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should handle prompt without maxTokens","status":"passed","title":"should handle prompt without maxTokens","duration":1.2369949999997516,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should handle custom temperature and maxTokens","status":"passed","title":"should handle custom temperature and maxTokens","duration":2.6526209999997263,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should handle streaming with memory context","status":"passed","title":"should handle streaming with memory context","duration":1.54261600000018,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should include systemPrompt when provided","status":"passed","title":"should include systemPrompt when provided","duration":1.4354060000000572,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should handle prompt with conversation context","status":"passed","title":"should handle prompt with conversation context","duration":1.4503560000002835,"failureMessages":[],"meta":{}},{"ancestorTitles":["chatWorkflow"],"fullName":"chatWorkflow should handle agent errors gracefully","status":"passed","title":"should handle agent errors gracefully","duration":4.868949000000157,"failureMessages":[],"meta":{}}],"startTime":1761055407114,"endTime":1761055407136.869,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow.test.ts"},{"assertionResults":[{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should execute workflow with valid input data and return response","status":"failed","title":"should execute workflow with valid input data and return response","duration":40.17619800000011,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:41:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should handle prompt without temperature","status":"failed","title":"should handle prompt without temperature","duration":4.053564999999935,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:63:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should handle prompt without maxTokens","status":"failed","title":"should handle prompt without maxTokens","duration":3.2276730000000953,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:82:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should handle custom temperature and maxTokens","status":"failed","title":"should handle custom temperature and maxTokens","duration":1.7678269999998975,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:102:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should include systemPrompt when provided","status":"failed","title":"should include systemPrompt when provided","duration":2.0552490000000034,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:139:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should handle structured output with action type","status":"failed","title":"should handle structured output with action type","duration":1.3895449999999983,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:177:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should handle structured output with complete type","status":"failed","title":"should handle structured output with complete type","duration":1.3335859999999684,"failureMessages":["AssertionError: expected 'failed' to be 'success' // Object.is equality\n    at /home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts:210:32\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at file:///home/sam/mastra-governed-rag/node_modules/@vitest/runner/dist/chunk-hooks.js:752:20"],"meta":{}},{"ancestorTitles":["chatWorkflow1"],"fullName":"chatWorkflow1 should handle agent errors gracefully","status":"passed","title":"should handle agent errors gracefully","duration":1.2297239999998055,"failureMessages":[],"meta":{}}],"startTime":1761055405681,"endTime":1761055405736.2297,"status":"failed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/workflows/tests/chatWorkflow1.test.ts"},{"assertionResults":[{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should execute workflow with valid input data and return final content","status":"passed","title":"should execute workflow with valid input data and return final content","duration":39.186825,"failureMessages":[],"meta":{}},{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should use default tone when not provided","status":"passed","title":"should use default tone when not provided","duration":4.227836000000025,"failureMessages":[],"meta":{}},{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should generate content for different content types","status":"passed","title":"should generate content for different content types","duration":11.648685999999998,"failureMessages":[],"meta":{}},{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should stream workflow events during execution","status":"passed","title":"should stream workflow events during execution","duration":2.785020999999915,"failureMessages":[],"meta":{}},{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should track token usage from AI calls","status":"passed","title":"should track token usage from AI calls","duration":2.5241799999998875,"failureMessages":[],"meta":{}},{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should handle Cedar context if provided","status":"passed","title":"should handle Cedar context if provided","duration":2.5170799999998508,"failureMessages":[],"meta":{}},{"ancestorTitles":["contentGenerationWorkflow"],"fullName":"contentGenerationWorkflow should respect minQualityScore threshold","status":"passed","title":"should respect minQualityScore threshold","duration":2.420669999999973,"failureMessages":[],"meta":{}}],"startTime":1761055405697,"endTime":1761055405762.4207,"status":"passed","message":"","name":"/home/sam/mastra-governed-rag/src/mastra/workflows/tests/contentGenerationWorkflow.test.ts"}]}