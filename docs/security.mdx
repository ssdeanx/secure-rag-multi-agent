import {
    Badge,
    Button,
    Card,
    CardContent,
    CardDescription,
    CardHeader,
    CardTitle,
    Alert,
    AlertDescription,
    AlertTitle,
    Tabs,
    TabsContent,
    TabsList,
    TabsTrigger,
    Mermaid,
    Shield,
    Users,
    Lock,
    Eye,
    EyeOff,
    AlertTriangle,
    CheckCircle,
    ArrowRight,
    FileText,
    Database,
    Settings,
    Key,
    Typography,
    Box,
} from '@/components/docs/mdx-bridge.joy'

# Security Model

The Multi-Domain AI Orchestration Platform implements a robust security framework using role-based access control (RBAC) with hierarchical inheritance, document classifications, and policy enforcement across all 27 agents and 5 capability domains. Security is integrated into the Mastra workflows to ensure users only access authorized content.

<Alert className="mb-6">
    <Shield className="h-4 w-4" />
    <AlertTitle>Zero-Trust Architecture</AlertTitle>
    <AlertDescription>
        Every query is authenticated and authorized at multiple pipeline stages
        with document access filtered based on user roles and classifications across all domains.
    </AlertDescription>
</Alert>

<!-- toc -->

## Role Hierarchy

Roles are defined in `src/mastra/config/role-hierarchy.ts`. Higher-level roles inherit permissions from lower ones, allowing granular access control.

### Role Structure

<Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(2, 1fr)', lg: 'repeat(3, 1fr)' }, gap: 2, mb: 3 }}>
  <Card variant="outlined">
    <CardHeader sx={{ pb: 1.5 }}>
      <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
        <Users sx={{ fontSize: 20, color: 'success.main' }} />
        Public (Level 10)
      </CardTitle>
      <CardDescription>Base access for unauthenticated users</CardDescription>
    </CardHeader>
    <CardContent>
      <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
        <li>• No inheritance</li>
        <li>• Basic public documents</li>
        <li>• No sensitive content</li>
      </Box>
    </CardContent>
  </Card>

<Card variant="outlined">
    <CardHeader sx={{ pb: 1.5 }}>
        <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <Users sx={{ fontSize: 20, color: 'primary.main' }} />
            Employee (Level 40)
        </CardTitle>
        <CardDescription>Inherits public access</CardDescription>
    </CardHeader>
    <CardContent>
        <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
            <li>• General company documents</li>
            <li>• Internal policies</li>
            <li>• Department overviews</li>
        </Box>
    </CardContent>
</Card>

<Card variant="outlined">
    <CardHeader sx={{ pb: 1.5 }}>
        <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <Eye sx={{ fontSize: 20, color: 'warning.main' }} />
            Department Viewer (Level 60)
        </CardTitle>
        <CardDescription>Read access to department content</CardDescription>
    </CardHeader>
    <CardContent>
        <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
            <li>• Department-specific content</li>
            <li>• Internal documents</li>
            <li>• Read-only access</li>
        </Box>
    </CardContent>
</Card>

<Card variant="outlined">
    <CardHeader sx={{ pb: 1.5 }}>
        <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <Settings sx={{ fontSize: 20, color: 'secondary.main' }} />
            Department Admin (Level 80)
        </CardTitle>
        <CardDescription>Full department access</CardDescription>
    </CardHeader>
    <CardContent>
        <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
            <li>• Full department access</li>
            <li>• Confidential documents</li>
            <li>• Administrative controls</li>
        </Box>
    </CardContent>
</Card>

  <Card variant="outlined">
    <CardHeader sx={{ pb: 1.5 }}>
      <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
        <Key sx={{ fontSize: 20, color: 'danger.main' }} />
        Super Admin (Level 100)
      </CardTitle>
      <CardDescription>Complete system access</CardDescription>
    </CardHeader>
    <CardContent>
      <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
        <li>• All roles and permissions</li>
        <li>• System administration</li>
        <li>• Security overrides</li>
      </Box>
    </CardContent>
  </Card>
</Box>

## Role Hierarchy Visualization

<Box sx={{ bgcolor: 'background.surface', p: 3, borderRadius: 1, mb: 3 }}>
  <Mermaid chart={`flowchart TD
    A[Super Admin<br/>Level 100] --> B[Department Admin<br/>Level 80]
    A --> C[Global Admin<br/>Level 90]
    B --> D[Department Viewer<br/>Level 60]
    C --> D
    D --> E[Employee<br/>Level 40]
    E --> F[Public<br/>Level 10]
    G[Specific Roles] --> D
    G --> E
    H[hr.viewer<br/>Level 60] --> G
    I[finance.viewer<br/>Level 60] --> G
    J[hr.admin<br/>Level 80] --> B
    K[it.admin<br/>Level 80] --> B
    style A fill:#ffebee
    style B fill:#fff3e0
    style D fill:#e8f5e8
    style F fill:#f3e5f5
    style G fill:#e3f2fd`} />

  <Typography level="body-sm" sx={{ mt: 2, color: 'text.tertiary' }}>
    <strong>Legend:</strong> Higher levels inherit permissions from lower levels. Arrows show inheritance direction.
  </Typography>
</Box>

### Specific Role Examples

<Box sx={{ overflow: 'auto', mb: 3 }}>
    <table
        style={{
            width: '100%',
            borderCollapse: 'collapse',
            border: '1px solid var(--joy-palette-divider)',
        }}
    >
        <thead>
            <tr
                style={{
                    backgroundColor: 'var(--joy-palette-background-surface)',
                }}
            >
                <th
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        textAlign: 'left',
                    }}
                >
                    Role
                </th>
                <th
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        textAlign: 'left',
                    }}
                >
                    Level
                </th>
                <th
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        textAlign: 'left',
                    }}
                >
                    Inherits From
                </th>
                <th
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        textAlign: 'left',
                    }}
                >
                    Access Scope
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        fontWeight: 'bold',
                    }}
                >
                    hr.viewer
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    60
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    employee, public
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    HR internal docs
                </td>
            </tr>
            <tr>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        fontWeight: 'bold',
                    }}
                >
                    finance.viewer
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    60
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    employee, public
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    Finance internal docs
                </td>
            </tr>
            <tr>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        fontWeight: 'bold',
                    }}
                >
                    engineering.viewer
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    60
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    employee, public
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    Engineering internal docs
                </td>
            </tr>
            <tr>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        fontWeight: 'bold',
                    }}
                >
                    hr.admin
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    80
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    hr.viewer, employee, public
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    All HR docs including confidential
                </td>
            </tr>
            <tr>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                        fontWeight: 'bold',
                    }}
                >
                    admin
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    100
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    All roles
                </td>
                <td
                    style={{
                        border: '1px solid var(--joy-palette-divider)',
                        padding: '12px',
                    }}
                >
                    Complete system access
                </td>
            </tr>
        </tbody>
    </table>
</Box>

## Document Classifications

Documents are classified during indexing with metadata enforced in storage and retrieval.

<Tabs defaultValue="classifications">
  <TabsList>
    <TabsTrigger value="classifications">Classifications</TabsTrigger>
    <TabsTrigger value="examples">Sample Documents</TabsTrigger>
    <TabsTrigger value="tags">Security Tags</TabsTrigger>
  </TabsList>

  <TabsContent value="classifications">
    <Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(3, 1fr)' }, gap: 2 }}>
      <Card variant="outlined">
        <CardHeader sx={{ pb: 1.5 }}>
          <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <Eye sx={{ fontSize: 20, color: 'success.main' }} />
            Public
          </CardTitle>
          <CardDescription>Accessible by all roles</CardDescription>
        </CardHeader>
        <CardContent>
          <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
            <li>• General company information</li>
            <li>• Public policies</li>
            <li>• Marketing materials</li>
            <li>• No sensitive data</li>
          </Box>
        </CardContent>
      </Card>
      <Card variant="outlined">
        <CardHeader sx={{ pb: 1.5 }}>
          <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <Lock sx={{ fontSize: 20, color: 'warning.main' }} />
            Internal
          </CardTitle>
          <CardDescription>Department-specific content</CardDescription>
        </CardHeader>
        <CardContent>
          <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
            <li>• Department policies</li>
            <li>• Internal procedures</li>
            <li>• Employee handbooks</li>
            <li>• Limited distribution</li>
          </Box>
        </CardContent>
      </Card>
      <Card variant="outlined">
        <CardHeader sx={{ pb: 1.5 }}>
          <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <EyeOff sx={{ fontSize: 20, color: 'danger.main' }} />
            Confidential
          </CardTitle>
          <CardDescription>Highly sensitive information</CardDescription>
        </CardHeader>
        <CardContent>
          <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
            <li>• Executive compensation</li>
            <li>• Legal documents</li>
            <li>• Financial data</li>
            <li>• Need-to-know basis only</li>
          </Box>
        </CardContent>
      </Card>
    </Box>

  </TabsContent>

  <TabsContent value="examples">
    <Box sx={{ mb: 2 }}>
      <Card variant="outlined" sx={{ mb: 2 }}>
        <CardHeader>
          <CardTitle>Finance Policy Manual</CardTitle>
          <CardDescription>finance-policy.md</CardDescription>
        </CardHeader>
        <CardContent>
          <Box sx={{ display: 'flex', gap: 1, mb: 1 }}>
            <Badge variant="soft" color="neutral">Internal</Badge>
            <Badge variant="outlined">Finance</Badge>
            <Badge variant="outlined">Policy</Badge>
          </Box>
          <Typography level="body-sm" sx={{ mb: 0.5 }}><strong>Allowed Roles:</strong> finance.viewer, finance.admin, employee</Typography>
          <Typography level="body-sm" sx={{ mb: 0.5 }}><strong>Classification:</strong> internal</Typography>
          <Typography level="body-sm"><strong>Tags:</strong> finance, policy, reimbursement</Typography>
        </CardContent>
      </Card>
      <Card variant="outlined" sx={{ mb: 2 }}>
        <CardHeader>
          <CardTitle>Engineering Handbook</CardTitle>
          <CardDescription>engineering-handbook.md</CardDescription>
        </CardHeader>
        <CardContent>
          <Box sx={{ display: 'flex', gap: 1, mb: 1 }}>
            <Badge variant="soft" color="neutral">Internal</Badge>
            <Badge variant="outlined">Engineering</Badge>
            <Badge variant="outlined">Development</Badge>
          </Box>
          <Typography level="body-sm" sx={{ mb: 0.5 }}><strong>Allowed Roles:</strong> engineering.viewer, engineering.admin, employee</Typography>
          <Typography level="body-sm" sx={{ mb: 0.5 }}><strong>Classification:</strong> internal</Typography>
          <Typography level="body-sm"><strong>Tags:</strong> engineering, development, practices</Typography>
        </CardContent>
      </Card>
      <Card variant="outlined">
        <CardHeader>
          <CardTitle>HR Confidential</CardTitle>
          <CardDescription>hr-confidential.md</CardDescription>
        </CardHeader>
        <CardContent>
          <Box sx={{ display: 'flex', gap: 1, mb: 1 }}>
            <Badge variant="solid" color="danger">Confidential</Badge>
            <Badge variant="outlined">HR</Badge>
            <Badge variant="outlined">Executive</Badge>
          </Box>
          <Typography level="body-sm" sx={{ mb: 0.5 }}><strong>Allowed Roles:</strong> hr.admin only</Typography>
          <Typography level="body-sm" sx={{ mb: 0.5 }}><strong>Classification:</strong> confidential</Typography>
          <Typography level="body-sm"><strong>Tags:</strong> hr, executive, compensation</Typography>
        </CardContent>
      </Card>
    </Box>

  </TabsContent>

  <TabsContent value="tags">
    <Card variant="outlined">
      <CardHeader>
        <CardTitle>Security Tag System</CardTitle>
        <CardDescription>How tags control document access</CardDescription>
      </CardHeader>
      <CardContent>
        <Box sx={{ mb: 2 }}>
          <Typography sx={{ fontWeight: 'bold', mb: 1 }}>Tag Generation</Typography>
          <Typography level="body-sm" sx={{ color: 'text.tertiary', mb: 1 }}>
            Each document chunk stores <Typography component="code" sx={{ bgcolor: 'background.surface', px: 0.5 }}>securityTags: string[]</Typography> derived from content analysis and metadata.
          </Typography>
          <Box sx={{ bgcolor: 'background.surface', p: 1, borderRadius: 0.5, fontSize: '0.875rem' }}>
            <strong>Example:</strong> finance-policy.md → <Typography component="code">['finance', 'policy', 'reimbursement']</Typography>
          </Box>
        </Box>
        <Box sx={{ mb: 2 }}>
          <Typography sx={{ fontWeight: 'bold', mb: 1 }}>Access Filtering</Typography>
          <Typography level="body-sm" sx={{ color: 'text.tertiary', mb: 1 }}>
            User roles determine <Typography component="code" sx={{ bgcolor: 'background.surface', px: 0.5 }}>allowTags: string[]</Typography> for filtering accessible documents.
          </Typography>
          <Box sx={{ bgcolor: 'background.surface', p: 1, borderRadius: 0.5, fontSize: '0.875rem' }}>
            <strong>Example:</strong> finance.viewer → <Typography component="code">allowTags: ['finance']</Typography>
          </Box>
        </Box>
        <Box>
          <Typography sx={{ fontWeight: 'bold', mb: 1 }}>Query Filtering</Typography>
          <Typography level="body-sm" sx={{ color: 'text.tertiary' }}>
            Retrieval queries filter by classification level AND matching security tags.
          </Typography>
        </Box>
      </CardContent>
    </Card>

  </TabsContent>
</Tabs>

## Policy Enforcement Pipeline

Security is enforced end-to-end via the Mastra query workflow:

<Box sx={{ bgcolor: 'background.surface', p: 3, borderRadius: 1, mb: 3 }}>
  <Mermaid chart={`flowchart TD
    A[User Query + JWT] --> B[JWT Validation]
    B --> C{Valid Token?}
    C -->|No| D[Authentication Error]
    C -->|Yes| E[Extract User Role]
    E --> F[Generate Access Filter]
    F --> G{maxClassification + allowTags}
    G --> H[Retrieve Agent]
    H --> I[Vector Search with Filter]
    I --> J[Qdrant DB]
    J --> K[Filter Results]
    K --> L[Authorized Documents Only]
    L --> M[Answer Generation]
    M --> N[Response with Citations]
    D --> O[Error Response]
    N --> P[Final Response]
    style A fill:#e3f2fd
    style H fill:#f3e5f5
    style M fill:#fff3e0
    style N fill:#e8f5e8`} />

  <Typography level="body-sm" sx={{ mt: 2, color: 'text.tertiary' }}>
    <strong>Security Flow:</strong> Every step validates permissions before proceeding to the next stage.
  </Typography>
</Box>

<Box sx={{ mb: 3 }}>
  <Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 2, mb: 2 }}>
    <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center', width: 32, height: 32, borderRadius: '50%', bgcolor: 'primary.main', color: 'white', fontWeight: 'bold', flexShrink: 0 }}>1</Box>
    <Card variant="outlined" sx={{ flex: 1 }}>
      <CardHeader sx={{ pb: 1.5 }}>
        <CardTitle>Authentication Step</CardTitle>
        <CardDescription>JWT validation and access filter generation</CardDescription>
      </CardHeader>
      <CardContent>
        <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
          <li>• Validate JWT token via AuthenticationService</li>
          <li>• Extract user role from token claims</li>
          <li>• Generate accessFilter with maxClassification and allowTags</li>
          <li>• Example: finance.viewer → maxClassification: 'internal', allowTags: ['finance']</li>
        </Box>
      </CardContent>
    </Card>
  </Box>

<Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 2, mb: 2 }}>
    <Box
        sx={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            width: 32,
            height: 32,
            borderRadius: '50%',
            bgcolor: 'primary.main',
            color: 'white',
            fontWeight: 'bold',
            flexShrink: 0,
        }}
    >
        2
    </Box>
    <Card variant="outlined" sx={{ flex: 1 }}>
        <CardHeader sx={{ pb: 1.5 }}>
            <CardTitle>Retrieval Step</CardTitle>
            <CardDescription>
                Filtered vector search with security constraints
            </CardDescription>
        </CardHeader>
        <CardContent>
            <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
                <li>• Query Qdrant with accessFilter applied</li>
                <li>• Filter by classification ≤ maxClassification</li>
                <li>• Match security tags with allowTags</li>
                <li>• Return only authorized document chunks</li>
            </Box>
        </CardContent>
    </Card>
</Box>

<Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 2, mb: 2 }}>
    <Box
        sx={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            width: 32,
            height: 32,
            borderRadius: '50%',
            bgcolor: 'primary.main',
            color: 'white',
            fontWeight: 'bold',
            flexShrink: 0,
        }}
    >
        3
    </Box>
    <Card variant="outlined" sx={{ flex: 1 }}>
        <CardHeader sx={{ pb: 1.5 }}>
            <CardTitle>Processing Steps</CardTitle>
            <CardDescription>
                Reranking and answer generation with authorized content
            </CardDescription>
        </CardHeader>
        <CardContent>
            <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
                <li>• Rerank agent processes only authorized contexts</li>
                <li>
                    • Answer agent generates responses from filtered content
                </li>
                <li>• Citations limited to accessible documents</li>
                <li>• No information leakage from unauthorized sources</li>
            </Box>
        </CardContent>
    </Card>
</Box>

  <Box sx={{ display: 'flex', alignItems: 'flex-start', gap: 2 }}>
    <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center', width: 32, height: 32, borderRadius: '50%', bgcolor: 'primary.main', color: 'white', fontWeight: 'bold', flexShrink: 0 }}>4</Box>
    <Card variant="outlined" sx={{ flex: 1 }}>
      <CardHeader sx={{ pb: 1.5 }}>
        <CardTitle>Verification Step</CardTitle>
        <CardDescription>Final compliance check</CardDescription>
      </CardHeader>
      <CardContent>
        <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
          <li>• Verifier agent checks answer for compliance</li>
          <li>• Validates no unauthorized information leakage</li>
          <li>• Ensures citations match accessible documents</li>
          <li>• Fails workflow if security violation detected</li>
        </Box>
      </CardContent>
    </Card>
  </Box>
</Box>

## Additional Security Features

<Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(2, 1fr)' }, gap: 2, mb: 3 }}>
  <Card variant="outlined">
    <CardHeader>
      <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
        <Database sx={{ fontSize: 20 }} />
        Tenant Isolation
      </CardTitle>
    </CardHeader>
    <CardContent>
      <Typography level="body-sm">
        All documents are scoped to a specific tenant (configurable in .env as TENANT). This ensures complete data isolation between different organizations or environments.
      </Typography>
    </CardContent>
  </Card>

<Card variant="outlined">
    <CardHeader>
        <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <FileText sx={{ fontSize: 20 }} />
            Audit Logging
        </CardTitle>
    </CardHeader>
    <CardContent>
        <Typography level="body-sm">
            All workflow steps are logged to mastra.log and workflow.log. This
            provides complete audit trails for compliance, monitoring, and
            forensic analysis.
        </Typography>
    </CardContent>
</Card>

<Card variant="outlined">
    <CardHeader>
        <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
            <Shield sx={{ fontSize: 20 }} />
            ACL Configuration
        </CardTitle>
    </CardHeader>
    <CardContent>
        <Typography level="body-sm">
            Base access control policies are defined in{' '}
            <Typography
                component="code"
                sx={{ bgcolor: 'background.surface', px: 0.5 }}
            >
                src/mastra/policy/acl.yaml
            </Typography>
            . This can be extended for custom security rules and organizational
            requirements.
        </Typography>
    </CardContent>
</Card>

  <Card variant="outlined">
    <CardHeader>
      <CardTitle sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
        <Key sx={{ fontSize: 20 }} />
        JWT Authentication
      </CardTitle>
    </CardHeader>
    <CardContent>
      <Typography level="body-sm">
        Tokens include role claims and are validated via the jwt-auth.tool. This ensures secure authentication with proper role-based access control.
      </Typography>
    </CardContent>
  </Card>
</Box>

## Best Practices

<Alert sx={{ mb: 3 }}>
    <CheckCircle />
    <AlertTitle>Principle of Least Privilege</AlertTitle>
    <AlertDescription>
        Always assign users the minimum role necessary for their job function.
        Use viewer roles by default and admin roles only when required.
    </AlertDescription>
</Alert>

<Box sx={{ display: 'grid', gridTemplateColumns: { xs: '1fr', md: 'repeat(2, 1fr)' }, gap: 2, mb: 3 }}>
  <Card variant="outlined">
    <CardHeader>
      <CardTitle>Document Classification</CardTitle>
    </CardHeader>
    <CardContent>
      <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
        <li>• <strong>Public:</strong> General information, no sensitive data</li>
        <li>• <strong>Internal:</strong> Department-specific, business operations</li>
        <li>• <strong>Confidential:</strong> Executive, legal, highly sensitive</li>
        <li>• Always classify documents appropriately during indexing</li>
      </Box>
    </CardContent>
  </Card>

  <Card variant="outlined">
    <CardHeader>
      <CardTitle>Role Management</CardTitle>
    </CardHeader>
    <CardContent>
      <Box component="ul" sx={{ m: 0, pl: 2, '& li': { mb: 0.5 } }}>
        <li>• Regularly review and update role assignments</li>
        <li>• Remove access when employees change roles</li>
        <li>• Use inheritance to simplify permission management</li>
        <li>• Document role responsibilities and access levels</li>
      </Box>
    </CardContent>
  </Card>
</Box>

<Card variant="outlined">
    <CardHeader>
        <CardTitle>Testing and Validation</CardTitle>
    </CardHeader>
    <CardContent>
        <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
            <CheckCircle sx={{ fontSize: 16, mr: 1, color: 'success.main' }} />
            <Typography level="body-sm">
                Use demo roles to simulate different access scenarios
            </Typography>
        </Box>
        <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
            <CheckCircle sx={{ fontSize: 16, mr: 1, color: 'success.main' }} />
            <Typography level="body-sm">
                Test role inheritance and permission boundaries
            </Typography>
        </Box>
        <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
            <CheckCircle sx={{ fontSize: 16, mr: 1, color: 'success.main' }} />
            <Typography level="body-sm">
                Validate document classifications match business requirements
            </Typography>
        </Box>
        <Box sx={{ display: 'flex', alignItems: 'center' }}>
            <CheckCircle sx={{ fontSize: 16, mr: 1, color: 'success.main' }} />
            <Typography level="body-sm">
                Regular security audits and access reviews
            </Typography>
        </Box>
    </CardContent>
</Card>

<Box sx={{ display: 'flex', gap: 2, mt: 3 }}>
    <Button
        component="a"
        href="/docs/demo-roles"
        startDecorator={<Users />}
        endDecorator={<ArrowRight />}
    >
        Try Demo Roles
    </Button>
    <Button
        variant="soft"
        component="a"
        href="/docs/api-reference"
        startDecorator={<FileText />}
    >
        API Reference
    </Button>
</Box>
